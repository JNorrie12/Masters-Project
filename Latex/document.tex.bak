\documentclass[12pt]{article}

\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{mathtools}
\usepackage{cleveref}
\usepackage{courier}
\usepackage{subcaption}
\usepackage{units}
\usepackage{float}
\usepackage{placeins}
\usepackage{babel}
\usepackage{needspace}
\usepackage{amssymb}
\usepackage[margin=1in]{geometry}
\graphicspath{{/home/john/Desktop/Project/Pictures/} }
%opening

\usepackage[nottoc]{tocbibind}

\title{Disjoint Tangled Nature Model}
\author{John Norrie, CID:01289535}
\date{September 14, 2017}
\setcounter{tocdepth}{5}

\begin{document}
\maketitle
\vspace{0.02\textheight}
\begin{center}
Supervisor: Henrik Jeldoft Jensen
\end{center}
\vspace{0.1\textheight}
\begin{figure}[H]
	\centering
		\includegraphics[width=.7\textwidth]{ICL.png}
\end{figure}
\vspace{0.2\textheight}
\begin{center}
\textit{The work contained in this thesis is my own work
	unless otherwise stated.}
\vspace{0.1\textheight}
\end{center}
\newpage
\section*{Summary}
The main intention of this project was to create a version of the Tangled Nature Model (TaNa) which models the affect that disimilar species in the same environment have on each other's evolutionary paths. In doing so the Disjoint Tangled Nature Model was created (DisTaNa), which has many interesting properties unique to itself, with features such as large extinction rates.\\
Analysis of this model starts with a simplification of the system. Since the original model have 512 dimensions, analysis is particularly tricky. Using the idea of thresholds species in the system can be classified into `cloud' (species with negligible populations) and `core' (species with significant populations) species, the former of which can be ignored. In doing so, the system can be approximated by a 2 dimensional system or the far rarer 3 dimensional system to a good degree of accuracy. This simplification is verified using a centre of mass function, and empirical data.\\ 
Linear stability analysis (LSA) was then used to describe the behaviour of the simplified 2D and 3D systems, providing an explanation for the large extinction rates, and uncovering the sensitivity of the equilibrium positions to the parameter $k$. Futhermore, discussing the 3D system's rarity and dependence on the interaction matrix J, points towards a possible new mechanism of transition new unknown to the TaNa model. \\
Using the idea that the model follows a new mechanism of transition, we analyse the transition frequencies and their dependence on the value $k$. Doing so reveals that the average number of transition follows a power law rather than the logarthmic behaviour exhibited by the TaNa model. Emprical data provides evidence to suggest that the logarthmic behaviour is a charactersitic of the high $k$ used in the TaNa model, which are not possible in the DisTaNa due to large trial extinctions, and the logarithmic behaviour of the transiton distribution occurs as $k \rightarrow \infty$.\\
After which we explore a theory as to why this may be the case inspired by analysing null model, $k=0$.\\
The final part of the project is focuses on population growth and how it differs from the TaNa model. This behaviour also may contradict the idea that the logarithmic behaviour is a limiting case of the system.
\newpage
\tableofcontents
\newpage
\section{Introduction}
Evolution is the popular scientific theory used to explain the variation and similarities expressed in the features and behaviours of distinct species. This theory posits that the random mutation of genes, coupled with natural selection, causes species to adapt to best suit their surroundings. This process is no more apparent than within Darwin's finches, a group of around fifteen finches studied by the eponymous biologist, which all developed characteristic beaks suited to eating specific foods. As Darwin himself states:\\
\textit{``Seeing this gradation and diversity of structure in one small, intimately related group of birds, one might really fancy that from an original paucity of birds in this archipelago, one species had been taken and modified for different ends.  In a like manner it might be fancied that a bird originally a buzzard, had been induced here to undertake the office of the carrion-feeding Polybori of the American continent."}\textbf{[1]}\\

\begin{figure}
		\centering
		\includegraphics[width=.5\textwidth]{Finches.jpg}
		\caption{Illustrations from Darwin's Voyage of the Beagle (John Gould) showing the variation of beak in four different finch species on the Galapagos islands.  }
\end{figure}
This theory of evolution is, of course, a corner-stone of modern biological understanding; and yet, due to its typically slow and gradual process, the effect of evolution on ecological systems is often difficult to observe or describe. However, understanding under what circumstances species adapt and bifurcate could shed light onto the past of our ancestors and the origin of life. In this project I will be adapting and analysing the Tangled Nature Model (Jensen et al, 2002), a model that takes the basic principles of evolution and applies them to a `genespace' in order to explain many of its phenomena. I will be altering this pre-existing model and reapplying it to scenarios involving multiple genespaces, in an attempt to explore the repercussions of evolution on common aspects of ecology, primarily competition and mutuation. 
\section{Tangled Nature Model}
In the Tangled Nature Model (TaNa) each species is represented as a binary sequence of length L denoted by $\textbf{S}^a = (S^a_1, ... S^a_L)$ with $S^a_i \in \{ +1,-1\}$. The physical interpretation of these sequences is that they represent a gene unique to each species. 
These elements create a `genespace' $\mathcal{S}$, with $2^L$ elements, which can be thought of a an L-dimensional hypercube, with each element $\textbf{S}^a$ representing a corner.\\
Each of these species has a population $n(\textbf{S}^a, t)$ which evolves in time dependant on three stochastic processes: death, birth and mutation.\\
A timestep is defined as a killing attempt followed by a reproduction attempt. For each of these processes, a member of the population is chosen at random. In the case of the killing attempt, the chosen individual is killed with probability $p_{kill}$ which is constant for all species and individuals. \\
For a reproduction attempt, again a member of the population is chosen at random and gives birth asexually with probability $p_{off}(\textbf{S}^a, t)$ defined as
\begin{equation}
p_{off}= \frac{exp(H(\textbf{S}^a,t))}{1 + exp(H(\textbf{S}^a,t))}
\end{equation}
Where $H(\textbf{S}^a,t)$ is the weight function. This function is defined as
\begin{equation}
H(\textbf{S}^a,t) = \frac{k}{N(t)}\sum_{\textbf{S}^b \in \mathcal{S}} J_{ab}n(\textbf{S}^b,t) - \mu N(t)
\end{equation}
Where $J_{ab}$ is the interaction effect that species b has on a.\\  
If a new member is born, it is not necessarily of the same species as the parent. Instead the parent is removed from the population and a mutation process is applied to two copies, where each gene in the gene sequence of that species changes with probability $p_{mut}$. \\
For instance, suppose $L=3$, an individual in species 2 (represented by $\textbf{S}^2 = [-1,1,-1]$) is chosen for a reproduction attempt. The probability that a copy is in $\textbf{S}^2$ is $p_0=(1-p_{mut})^3$.\\
Using time steps as a timescale is not particularly useful when analysing this model, as they are too small. Instead generations are used. A generation is defined by the average number of timesteps that an individual is alive for, or mathematically $\frac{N(t)}{p_{kill}}$.
\subsection{Interaction Matrix}
As show by equation (2), the probability of reproduction is dependent on a matrix $J$, which represents the effect that the species have on each other. The entries of J can either be positive, representing a helpful interaction; negative, representing a harmful interaction; or zero, representing no interaction at all.\\
A given interaction couplet, $J_{ab}$ \& $J_{ba}$ has non-zero entries with probability $\theta$. If they are indeed non-zero, they are then chosen from a uniform distribution, $U(-1,1)$.\\
In order to only focus on the effects species have on each other, $J_{aa}=0$. No species has any interaction value on itself.


\begin{figure}[H]
	\centering
	\includegraphics[width=.5\textwidth]{interactions2.png}
	\caption{Diagram from Jensen et al, 2002 {\textbf{[2]}} of a 3 dimensional genome space (L=3). The edges of the cube can be traversed via mutation, and the number of edges between two vertices represents the Hamming distance between them.  The solid curves represent the interactions between species, and the thickness relates to the strength of the interaction, whereas the size of each vertex represents the size of the population of that species.}
\end{figure}  
\subsection{Behaviour}
The application of these mechanisms over many generations gives way to distinct macro-dynamics. The model is characterised by the overall population having long periods of relative stability, followed by intermittent bursts of chaos. These `stable' periods, also known as quasi-evolutionary stable strategies (q-ESS), are reached when the dominant species in the system are in such a configuration that the system exhibits a degree of stability significant enough to overcome the constant mutation forced by the model. After a time the system leaves the q-ESS state and moves into chaos, where the populations shift rapidly until a new q-ESS is found. 
\begin{figure}[H]
	 	\makebox[\linewidth][c]{%
	 		\begin{subfigure}{.6\textwidth}
	 			\centering
	 			\includegraphics[width=\textwidth]{BEST3.png}
	 			\caption{}
	 		\end{subfigure}%
	 		\begin{subfigure}{.6\textwidth}
	 			\centering 
	 			\includegraphics[width=\textwidth]{BEST4.png}
	 			\caption{}
	 		\end{subfigure}
	 	}
	\caption{Figure (a) shows the overall population of the system for 5000 generations. Figure (b) shows the species in existence for 5000 generations, where each species label is the base 10 representation each species' respective gene. The parameters for this trial were L=9, $\theta$=0.75, $p_{mut}$=0.01, $p_{kill}$=0.25, $k$=50, $\mu$=0.005. It is apparent that the q-ESS, characterised by relative stability in (a), correspond to the separate periods in (b) where different species dominate. With every switch between q-ESS the populations reshuffle such that new and different species emerge and become dominant.}
\end{figure}  
As the system evolves over time, the q-ESS become more stable, and the number of transitions become less frequent, decreasing logarithmically. The ecological interpretation of this is that over time the species become more adapted to their surroundings, and make better use of resources. This is similarly shown by the increasing overall average population.
\begin{figure}[H]
	\centering
	\includegraphics[width=.5\textwidth]{Population.jpg}
	\caption{The increase in population in the TaNa model, known as the `time arrow'. Figure from Jones et al. 2013}
\end{figure}
\section{Disjoint Tangled Nature Model}
Although excellent at showing how mutation causes evolution within closely related species, the TaNa model does not capture the effect of species who live in the same environment but are so differently evolved that they cannot mutate into one another. A good example of this is the parasite-host relationship, such as that which exists between dogs and fleas. Both the dog and the flea interact with each other and, if given a long enough time, will definitely affect each other's evolutionary path; however it is not very often one sees a dog mutate into a flea. The Disjoint Tangled Nature Model (DisTaNa) is an attempt at modelling this scenario.\\ 
To model the influence that disimilar species have on each other would require a genescape large enough that there is vitrually no probability of cross mutation. Mathmatically, species $\textbf{S}^a$ and $\textbf{S}^b$ are part of the genespace $\mathcal{S} = \{-1, +1 \}^L$ for $L \gg1$ and $d(\textbf{S}^a, \textbf{S}^b) \gg 1$. Since the distance between these two species is so high, we can approximate the probability of inter-species mutation, $p_{mut}^{a \leftrightarrow b}=0$.\\
However this is obviously not feasable, and therefore the model must be simplified. By having instead two distinct genespaces $\mathcal{U}_1 = \{-1, 1\}^{L_1}$ and $\mathcal{U}_2 = \{-1, 1\}^{L_2}$ where species are allowed to evolve and mutate within their respective genespace, but cannot mutate into the opposite genespace, is a reasonable substitute. \\
Like TaNa each timestep is defined by an individual being randomly chosen and killed with probability $p_{kill}$ followed by another individual being randomly chosen to reproduce with probability  $p_{off}$. However, the structure of the interaction matrix J must be altered. To focus on the interactions between the two genespaces, all interactions between species in the same genespace are set to zero. I.e.
\begin{equation}
J_{ab}= \begin{cases}
0  & \text{if }  {\textbf{S}^a}\bigcap {\textbf{S}^b} \subset \mathcal{U}_i, \quad i=\{ 1, 2\}\\
\sim U(-1,1) \quad with \quad probability\quad \theta   & Otherwise.
\end{cases}
\end{equation}
This interaction matrix is equivalent to the adjacency matrix of a bipartite graph, creating two sets which only interact with the opposite set.
The weight function is also changed to suit this difference. The overall population $N(t)$ is split into two separate populations, $N_1(t)$ and $N_2(t)$, which are the populations of the combined species in genespaces $\mathcal{U}_1$ and $\mathcal{U}_2$ respectively. The weight function H is therefore defined as
\begin{equation}
H(\textbf{S}^a,t) = \begin{cases}
\frac{k}{N_2(t)}\sum_{\textbf{S}^b \in \mathcal{S}} J_{ab}n(\textbf{S}^b,t) - \mu N_1(t)
  & \text{if }  \textbf{S}^a \in \mathcal{U}_1 \\
\frac{k}{N_1(t)}\sum_{\textbf{S}^b \in \mathcal{S}} J_{ab}n(\textbf{S}^b,t) - \mu N_2(t)
  & \text{if }  \textbf{S}^a \in \mathcal{U}_2
\end{cases}
\end{equation}
This is done because the first term is completely dependent on the populations in the opposite genespace, and so it makes more sense to 'normalise' the term by the total population in the opposite gene space. Normalising with the entire population (as done in the TaNa model) does not have a physical interpretation in this model. \\
Likewise, the second term acts as a 'soft boundary', meaning that as a population grows large, $p_{off}$ decreases, avoiding exponential growth. In some cases having both populations affect this term may be preferential, for instance if the two species use the same limited amount of space or resources, however it is not necessary. Limiting to one of the populations helps focus on the interactions between the two genespaces. A single $\mu$ value has been used for simplicity but in future models two (one for each genespace) can be used.
\begin{figure}[H]
	\centering
	\includegraphics[width=.5\textwidth]{interactions.png}
	\caption{Diagram of the networks involved in the model. The blue cubes represent the hypercube structure of the two genespaces $\mathcal{U}_1$ and $\mathcal{U}_2$ ($L_1, L_2 =3$), with every vertex representing a separate species, the populations of which relate to the size of each vertex (red). The interactions are represented by the red lines between vertices. Note that in the model there is no interaction between species in the same genespace, and that interactions have direction (and hence two nodes can have more than one edge connecting them). These two facts make it possible to portray the interactions as a bipartite graph.}  
\end{figure}
\subsection{Implementation and Behaviour}
The model was created using C++ (code in the appendices), and was based off a previous piece of code used to simulate the original TaNa model by Lorenzo Palmieri. I focused on $L_1=8$ and $L_2=8$ which implies that each genespace contains 256 species. This is large enough to observe transitions between q-ESS states.\\
Unlike that of the TaNa, the nature of the DisTaNa varied drastically from simulation to simulation. Figure 5 shows two extreme examples of this. Using the same parameters it was possible to find very stable runs (as shown by (a) and (b)), where a q-ESS is found very quickly and is stable enough that the species stay in this configuration indefinitely, whilst also being possible to find very unstable runs (such as (c) and (d)), where short q-ESS epochs are present and bridged by chaotic interludes. Many times these chaotic periods were violent enough to cause extinction of one or both species.\\
\begin{figure}
		 	\makebox[\linewidth][c]{%
		 		\begin{subfigure}{.6\textwidth}
		 			\centering
		 			\includegraphics[width=\textwidth]{2data1.png}
		 			\caption{}
		 		\end{subfigure}%
		 		\begin{subfigure}{.6\textwidth}
		 			\centering 
		 			\includegraphics[width=\textwidth]{2data2.png}
		 			\caption{}
		 		\end{subfigure}
		 	}
		 			\\
		 		\makebox[\linewidth][c]{%
			 	 	\begin{subfigure}{.6\textwidth}
		 				\centering 
		 				\includegraphics[width=\textwidth]{3data1.png}
		 				\caption{}
			 	 	\end{subfigure}%
		 			\begin{subfigure}{.6\textwidth}
			 	 		\centering 
		 				\includegraphics[width=\textwidth]{3data2.png}
		 				\caption{}
		 			\end{subfigure}
		 			}
		 	\caption{Figures (a), (b) and (c), (d) are two simulations of the DisTaNa using the same parameters. They represent the two extremes of the possible outcomes in using this model. The parameters were $L_{1,2}=8$, $\theta = 0.25$, $p_{mut}= 0.005$, $p_{kill}= 0.2$, $k= 5$, $\mu = 0.007$. (b) \& (d) show the species alive at a given generation, blue being the species in genespace 1 and red in genespace 2. The green linesrepresent the 'centre of mass' of each genespace for a given generation. This is concept which will be developed further in chapter 5. (a) \& (c), the populations in genespace 1 and 2 are shown in blue and red respectively. The overall population is shown in green.}
\end{figure}
Since all other parameters are also present in the TaNa model, the main difference between the models is the interaction matrix $J$. When choosing the non-zero elements of $J$ in the range [0,1], instead of [-1,1], the chaotic periods no longer end in extinction, as they often did before. Therefore we deduce that the DisTaNa model must be more sensitive to the randomised entries in the matrix than the TaNa model, giving way to new and interesting behaviour.
\section{Equilibrium without interactions}
The simplest case to look at is where there are no interactions between species. In terms of the model, $J_{ab}=0$ for all $a,b$, are equivelantly $k=0$. Without the J matrix we can express the model's dynamics by two separate equations, one for each genespace.
\begin{equation}
	\delta N_i(t) = (p_{off} - p_{kill})N_i(t) \quad \quad  \quad i=1,2
\end{equation}
where $p_{off}$ is described as 
\begin{equation}
	p_{off}= \frac{exp(-\mu_{i} N_i(t))}{1 + exp(-\mu N_i(t))}
\end{equation}
The stable point in this case if given when $\delta N_i(t)=0$, and there we find the equilibrium points
\begin{align*}
& 0 = (p_{off} - p_{kill})N_i(t) \\[.7em]
 \Longrightarrow \quad &\frac{exp(-\mu N_i(t))}{1 + exp(-\mu N_i(t))}= p_{kill} \\[.7em]
& exp(-\mu N_i(t)) = \frac{p_{kill}}{1-p_{kill}}
\end{align*}
And so the equilibrium for each genespace is achieved by
\begin{equation}
	N_i = \frac{1}{\mu} ln\left(\frac{1-p_{kill}}{p_{kill}}\right)
\end{equation} 
Not much can be said for the exact populations of the individual species. The populations are modelled by
\begin{equation}
	\delta N_i(t) = (p_{off} - p_{kill})N_i(t) \quad \textbf{S}^a \in \mathcal{U}_i
\end{equation} 
Since these equations are only dependent on overall populations, which as discussed are in equilibrium, the only fluctuations come from the stochastic process of mutation, which acts as a diffusive process in this regard. 

\begin{figure}[H]
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.6\textwidth}
			\centering
			\includegraphics[width=\textwidth]{Stable1.png}
			\caption{}
		\end{subfigure}%
		\begin{subfigure}{.6\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{Stable2.png}
			\caption{}
		\end{subfigure}
	}
	\caption{Parameter for this simulation were $L_{1,2}=8$, $\theta = 0.25$, $p_{mut}= 0.005$, $p_{kill}= 0.2$, $k= 0$, $\mu_1 = 0.007$, $\mu_2=007$. (a), blue shows the population in genespace 1 and red in genespace 2. Green is overall population. Using the above formula the theoretical stable point for each genespace population is 198, which is in accordance with the data. (b) blue and red show the populations extistent at a given generations. The stochastic and diffusive nature of the individual species can be seen, as they come in and out of existence sporadically.}
\end{figure}  
\section{Centre of Mass and Thresholds}
When adding in interactions analysis becomes difficult, as we can no longer ignore the individual species. With $2^{L_1}+2^{L_2}$ (512 in our case)  separate variables, each dependent on one another, even simple linear stability analysis becomes difficult and simplification becomes necessary. \\
A technique proposed in Piovonia  et al. 2016 \textbf{[5]} is that of thresholding. This uses the assumption that the majority of the population is dominated by a few species (core species), rather then being spread out equally across the existing species. The other species with relatively small populations (cloud species) have very little effect on the dynamics of the q-ESS regions. Using this assumption, we can disregard many of the species which do not possess a certain threshold percentage of the overall population. \\
In order to verify this assumption, a centre of mass (CoM) function was used, which helps determine in which species the majority of the population lies. Let $i$ be the species label(the base 10 conversion of a species' binary gene representation), then the CoM is defined as
\begin{equation}
C_j = \sum_{i = 0}^{2^{L_j}} i \frac{n_i(t)}{N_j(t)}
\end{equation}
Applying this function revealed that in the majority of cases, the population in both genespaces was almost entirely part of a single species. Figure 6(d) shows that this is not always the case, however even then it is apparent there are only 3 dominant species in the system. In fact by creating a threshold of just 5\% can reduce the system dimensions form 256 to 2 core species(figure 8). For the rest of the population analysis this simplification will be assumed. When terms such as `2D' and `3D' system are used it refers to the number of core species, not the actual number of species in the system. This approximation, although large, will be shown throughout the project to be an accurate.
\begin{figure}
		 	\makebox[\linewidth][c]{%
		 		
		 		\begin{subfigure}{.6\textwidth}
		 			\centering
		 			\includegraphics[width=\textwidth]{1data2.png}
		 			\caption{}
		 		\end{subfigure}%
		 		\begin{subfigure}{.6\textwidth}
		 			\centering 
		 			\includegraphics[width=\textwidth]{1data3.png}
		 			\caption{}
		 		\end{subfigure}
		 	}
		 	\caption{(a) shows a typical simulation, the centre of mass for each genespace (green)is at the position of the only continuous species. This implies that the majority of the population resides there. (b) shows the populated species present when adding a threshold of 5\% which is used in Becker and Sibani 2013 \textbf{[8]} to differentiate between cloud and cluster species. At a given generation outside in a q-ESS the system is reduced to a system of 2 population. In the shifts the population distributes over more species before rearranging into the next q-ESS.}
	
\end{figure}
\section{2 Dimensional System}
The following few chapters will focus on the stability in the q-ESS states. As before shown, the system can be collapsed to only envolve 2 core species. 
\subsection{Equilibrium}
In this case have the two core species, $\textbf{S}^1 \in \mathcal{U}_1$ and $\textbf{S}^2 \in \mathcal{U}_2$. The weight function is simplified to
\begin{align}
H(\textbf{S}^a,t) &= \frac{k}{N_i(t)}\sum_{\textbf{S}^b \in \mathcal{S}} J_{ab}n(\textbf{S}^b,t) - \mu N_j(t)\\[.7em]
H(\textbf{S}^a,t) &= \frac{k}{n(\textbf{S}^b,t)}J_{ab}n(\textbf{S}^b,t) - \mu n(\textbf{S}^a,t)\\[.7em]
\Rightarrow H(\textbf{S}^a,t) &= kJ_{ab} - \mu n(\textbf{S}^a,t)
\end{align}
The weight function no longer has dependence of the opposite population.\\
Since we are neglecting the population in  the cloud species, we can neglect the effect of mutation from the cloud species into the core species. Conversely, we should not neglect the effect of mutation outwards, from the core into the cloud, as it has a much larger event probability. We then assume this outwardly mutated member is part of a cloud species with very few members and therefore has negligible effect on the dynamics. Therefore the populations can be modelled by: 
\begin{equation}
\delta n_a(t)= ((1-2p_{out})p^a_{off}-p_{kill})n_a(t) \quad\quad a={1,2}
\end{equation}
Where $p_{out}=1-(1-p_{mut})^L$ is the probability of the offspring mutating out of the core species. 
Therefore the non-trivial equilibrium point is satisfied when 
\begin{equation}
	p^a_{off}= \frac{p_{kill}}{1-2p_{out}}= P
\end{equation}
 Continuing the calculation in terms of $P$. 
\begin{align*}
	P &= \frac{exp(H_a(t))}{1 + exp(H_a(t))}\\[.7em]
	\Rightarrow H_a(t) &= ln\left(\frac{1-P}{P}\right)
\end{align*}
Therefore for each species, population is achieved at
\begin{equation}
	 n^*_a(t) = \frac{1}{\mu}\left(ln\left(\frac{1-P}{P}\right) + k J_{ab}\right) 
\end{equation}
This helps to explain the sensitivity to the interaction matrix and why extinction is so common. For a given population, in order for no extinction to occur, we require the equilibrium to be $n^*_a(t) \ge 0$. Therefore using equation (15),
\begin{equation}
	\frac{1}{\mu}\left(ln\left(\frac{1-P}{P}\right) + k J_{ab}\right) \ge 0\\ 
\end{equation}
Since $J_{ab} \in [-1,1]$, for any given species,
\begin{equation}
		\frac{1}{\mu}\left(ln\left(\frac{1-P}{P}\right) + k J_{ab}\right) \ge \frac{1}{\mu}\left(ln\left(\frac{1-P}{P}\right) - k\right) \ge 0
\end{equation}
And therefore a suitable k for no extinction to happen is
\begin{equation}
k \le ln\left(\frac{1-P}{P}\right) = \xi . 
\end{equation}
The simulations so far have used $p_{kill}=0.2$, and $p_{mut}=0.005$ which implies that for extinction to be prevented $k \le 1.283$. However, in prior simulations $k = 5$ was used, which explains the frequency of extinctions. In fact, with this parameters, extinction is certain for any 2D q-ESS with interaction entries, $J_{ba}$ or $J_{ab}>-0.277$. This is very different from the behaviour of the original TaNa model, where k values of 40 were possible.
\begin{figure}[H]
		 	\makebox[\linewidth][c]{%
		 		\begin{subfigure}{.6\textwidth}
		 			\centering
		 			\includegraphics[width=\textwidth]{4data1.png}
		 			\caption{}
		 		\end{subfigure}%
		 		\begin{subfigure}{.6\textwidth}
		 			\centering 
		 			\includegraphics[width=\textwidth]{4data2.png}
		 			\caption{}
		 		\end{subfigure}
		 	}
		 	\caption{(a) and (b) represent a typical simulation with parameters $L_{1,2}=8$, $\theta = 0.25$, $p_{mut}= 0.005$, $p_{kill}= 0.2$, $k= 5$, $\mu = 0.007$. The two dominant species in the q-ESS which lies approximately between generation 0 and 1900 are 115(blue) and 302(red). The corresponding interaction entries are $J_{302, 115}= 0.57722$ and $J_{115, 302}= 0.9902$. Using equation (15), the theoretical equilibrium populations are given by 595 and 890 respectively, which is in accordance with graphical data. (b) The CoM (green) follows the only 2 continuous generations, implying that the other species have negligible populations.}
\end{figure}
\subsection{Extreme k and Extinctions}
Although we can avoid having strategies with negative equilibria (safe strategies) by having
\begin{equation}
k < ln\left(\frac{1-P}{P}\right) = \xi
\end{equation}
It is not correct to conversely say that one would expect extinctions for $k>\xi$. In fact as will be shown in the 3 dimensional cases, systems with higher interaction couplings are favoured, and therefore in the majority of cases unsafe strategies would not be chosen. To better understand extinction one must instead look at the proportion of unsafe strategies for a given k and $\xi$.
\\
The probability that a given non-zero entry of J, would produce and extinction is given by
\begin{equation}
P(\xi + kx < 0) \text{\quad with \quad} x \sim U(-1,1)  
\end{equation}
Which is equivalent to 
\begin{align}
&=P\left(x < -\frac{\xi}{k}\right) \text{\quad with \quad} k \in [\xi, \infty) \\
&=\int_{-\infty}^{-\frac{\xi}{k}}f(x) \, dx \quad = \quad \int_{-1}^{-\frac{\xi}{k}} \frac{1}{2} \, dx \\
&=\frac{1}{2}\left(1- \frac{\xi}{k}\right) \quad k \in [\xi, \infty)
\end{align}
Therefore we see the proportion of unsafe J interactions is inversely proportional to k. \\
This effect is then amplified when considering the 2D strategies which constitute for the majority of the q-ESS's. We define a strategy $s(x_1, x_2)$ as `safe' if both members of the interaction couplet are greater than that necessary for extinction to occur. The probability of a given strategy with non-zero J entry being safe is therefore
\begin{align}
P\left(s(x_1,x_2) \quad safe \right) &= P\left(x_1 > -\frac{\xi}{k}\right)P\left(x_2 > -\frac{\xi}{k}\right) \quad \text{iid}\\[.7em]
&=\left[1 - P\left(x_1 < -\frac{\xi}{k}\right)\right]\left[1 - P\left(x_2 < -\frac{\xi}{k}\right)\right] \\[.7em]
&=\left[1 - \frac{1}{2}\left(1-\frac{\xi}{k}\right)\right]\left[1 - \frac{1}{2}\left(1-\frac{\xi}{k}\right)\right]\\[.7em]
&= \frac{1}{4}\left(1+\frac{\xi}{k}\right)^2 \quad k \in [\xi, \infty)
\end{align}
Since this is a smooth function, we would also expect the number of extinctions for a given $k$ to act smoothly, rather then $k=\xi$ being a hard cut-off. This is indeed what we see experimentally. 
\begin{figure}[H]
	\centering
	\includegraphics[width=.7\textwidth]{extinction.png}
	\caption{Blue shows the proportion of unsafe J, described by (23). Red shows the proportion of unsafe strategies, $1- (27)$. The black points represent the proportion of trials which lead to extinction. The proportion of extinction for $k=2,3,4,5$ are $0.29\%$, $9.93\%$, $26.6\%$, $50.9\%$.  }
\end{figure}
Although the probability of extinction obviously follows have a very different dependence on k, it does help explain how extinction is not necessarily certain for $k>1.28$. In fact during trials of $k=1.6$, extinction was never observed, and $k=2$ it was only observed once in 400 trials. This does allow us to experiment with higher k. Most subsequent simulations will used $k=1.3$ as standard. 
\subsection{Liner Stability Analysis}
In order to analyse the stability at the equilibrium points, the techniques of linear stability analysis (LSA) will be employed. The equation (13) describes the dynamics for each population of the system. Therefore the linearised matrix is given by
 \[
 M=
 \left( {\begin{array}{cc}
 	(1-2p_{out})\frac{\partial p_{off}^1}{\partial n_1}n_1 + (1-2p_{out})p^1_{off} - p_{kill} & (1-2p_{out})\frac{\partial p_{off}^1}{\partial n_2}n_1 \\[.7em]
 	(1-2p_{out})\frac{\partial p_{off}^2}{\partial n_1}n_2 & (1-2p_{out})\frac{\partial p_{off}^2}{\partial n_1}n_2 + (1-2p_{out})p_{off} - p_{kill} \\
 	\end{array} } \right)  \Bigg\rvert_{n= n*} 
 \]
The non-trivial equilibrium is achieved when $p_{off} - P =0$. Therefore

\[
M=
(1-2p_{out})\left( {\begin{array}{cc}
	\frac{\partial p_{off}^1}{\partial n_1}n^*_1 & \frac{\partial p_{off}^1}{\partial n_2}n^*_1 \\
	\frac{\partial p_{off}^2}{\partial n_1}n^*_2 & \frac{\partial p_{off}^2}{\partial n_1}n^*_2\\[.7em]
	\end{array} } \right)
\]
Using the chain rule
\begin{equation}
	\frac{\partial p^i_{off}}{\partial n_j} = \frac{exp(H_i)}{(1+ exp(H_i))^2}\frac{\partial H_i}{\partial n_j} = \alpha_i \frac{\partial H_i}{\partial n_j}
\end{equation}
In the two dimensional case the weight function for each population is independent of the opposing population, therefore 
\begin{equation}
	\frac{\partial p^i_{off}}{\partial n_j}=0 \text{ for } i \ne j
\end{equation}
The none zero derivatives of the weight function are given by
\begin{equation}
	\frac{\partial H_i}{\partial n_i} = -\mu
\end{equation}
And so the final linearised matrix is given by
	\[
	M= (1-2p_{out})
	\left( {\begin{array}{cc}
		-\mu \alpha_1 n^*_1  & 0 \\
		0 & -\mu \alpha_2 n^*_2\\
		\end{array} } \right)
	\]
Since this matrix is in the diagonal form the corresponding eigen values and eigen vectors are given by 
\begin{equation}
	\begin{array}{c}
	\lambda_1 = -(1-2p_{out})\mu \alpha_1 n^*_1 \quad \text{   with   } \quad \boldsymbol{v}_1 = \	\left( {\begin{array}{c}
		1 \\
		0 \\
		\end{array} } \right) \\
		\lambda_2 = -(1-2p_{out})\mu \alpha_2 n^*_2 \quad \text{   with   } \quad \boldsymbol{v}_2 = \	\left( {\begin{array}{c}
			0 \\
			1 \\
			\end{array} } \right)
	\end{array}	
\end{equation}
Since $\alpha$ is a strictly positive function and assuming that $ p_{out}<0.5$ and $n^*_1 > 0$ this system is asymptotically stable for any two species. 
\section{3 Dimensional System}
Although far less common than the 2 dimensional q-ESSs, 3 dimensional q-ESSs do exist and should be analysed.
Unlike the 2 dimensional, mutation between core species is present in the dynamics. Assume species 1 and 2 are in the same genespace, and 3 is in the opposing genespace. Then the system is describe by equations
\begin{align}
	\delta n_i(t) &= ((1-2p_{out})p^i_{off}-p_{kill})n_i + 2p_{in}p^j_{off}n_j \\[.7em]
	\delta n_3(t) &= ((1-2p_{out})p_{off}-p_{kill})n_3 \\[.7em]
	\quad \text{for} \quad &i,j=1,2 \quad i \ne j
\end{align}
Where $p_{in}$ is the distance dependent cross-mutation probability. Let $d$ be the Hamming distance between species 1 and 2. Then $p_{in} = p^d_{mut}(1-p_{mut})^{L-d}$. This is the probability for species 1 to mutate into species 2 and vice versa.
\subsection{Equilibria}
We have that the fixed point is achieved when 
\begin{align}
\delta n_1(t) &= 0 \quad (a)\\
\delta n_2(t) &= 0 \quad (b)\\
\delta n_3(t) &= 0 \quad (c)
\end{align} 
However with the complication of inward mutation, no analytic expression for the solutions for the equilibria of (35-37). Solutions however do exist.\\
For example one solution is when $n_2 = 0$. Then the equations simplify to 
\begin{align}
	(1-2p_{out})p^1_{off} - p_{kill} &= 0\\
	(1-2p_{out})p^3_{off} - p_{kill} &= 0 \\
\end{align}
Which gives analytic solutions
\begin{align}
	n_1 &= \frac{1- P}{P} + kJ_{1,3}\\
	n_3 &= \frac{1- P}{P} + kJ_{3,1}\\
\end{align} 
Here we recover the 2-dimensional system. In order to approximate more interesting solutions, the probability $p_{in}$ will be approximated as zero. This is viable approximation to make since $p_{in}$ is very small relative to the other probabilities.
Taking $p_{mut} = 0.005$(Which has been used in simulations) taking $d=1$, the closest the two species can be, we have $p_{in}=0.00483$. Allowing this assumption will enable us to find analytic approximations of the equilibria. \\
\subsection{Negligible Mutation}
Using the assumption proposed in the last section, the inward mutation between core species will be set to zero. Therefore the simplified system follows the dynamics
\begin{equation}
\delta n_i = ((1-2p_{out})p_{off}- p_{kill}) n _i \quad for \quad i=1,2,3
\end{equation}
This set of equations has 3 notable cases of behaviour.
\subsubsection{Case (a)- $\boldsymbol{n_1}$ and $\boldsymbol{n_2 >0}$}
Case (a) is an example of a fixed point where neither $n_1$ nor $ n_2$ are extinct, and have significant populations. In which case the equilibrium populations are given by
\begin{align}
n_1 + n_2  &= \frac{1}{\mu}(ln(\frac{1- P}{	P}) + kJ_{1,3})\\
n_1 + n_2  &= \frac{1}{\mu}(ln(\frac{1- P}{P}) + kJ_{2,3})\\
n_3 &= \frac{1}{\mu}(ln(\frac{1 - P	}{P}) - k\frac{J_{3,1}n_1 + J_{3,2}n_2}{n_1 + n_2})
\end{align}
The first two equations have a solution if and only if $J_{1,3}=J_{2,3}$. This could account for the rarity of finding a 3 species system, and indeed makes it a special case. \\
It is not a single equilibrium point, but a line that satisfies the equations above. Let $(n^*_1, n^*_2,n^*_3)$ be any fixed point on the line expressed by (45-47), with $n^*_i>0$.
Linearising about this point, we retrieve a general stability matrix 
	 \[
	 M=(1-2p_{out})
	 \left( {\begin{array}{ccc}
	 	-\mu \alpha_1 n_1 + p^1_{off} - P & -\mu \alpha_1 n_1 & 0\\[.7em]
	 	-\mu \alpha_2 n_2 & -\mu \alpha_2 n_2 + p^2_{off} - P & 0\\[.7em]
	 	\frac{kn_2n_3 \alpha_3 }{(n_1 + n_2)^2}(J_{3,1}-J_{3,2}) & \frac{kn_1n_3\alpha_3}{(n_1 + n_2)^2}(J_{3,2}-J_{3,1}) & -\mu \alpha_3 n_3 + p^3_{off} - P\\
	 	\end{array} } \right)  \Bigg\rvert_{n= n*} 
	 \]
Which simplifies to
\[
M= (1-2p_{out})
\left( {\begin{array}{ccc}
	-\mu \alpha_1 n^*_1 & -\mu \alpha_1 n^*_1 & 0\\[.7em]
	-\mu \alpha_2 n^*_2 & -\mu \alpha_2 n^*_2 & 0\\[.7em]
	\frac{kn^*_2}{(n^*_1 + n^*_2)^2}(J_{3,1}-J_{3,2}) & \frac{kn^*_1}{(n^*_1 + n^*_2)^2}(J_{3,2}-J_{3,1}) & -\mu \alpha_3 n^*_3\\
	\end{array} } \right)
\]
The eigenvalues and corresponding eigenvectors for this are
\begin{equation}
	\begin{array}{c}
	\lambda_1 = -\mu (1-2p_{out})(\alpha_1 n^*_1+ \alpha_2 n^*_2) \quad \text{   with   } \quad \boldsymbol{v}_1 = \	\left( {\begin{array}{c}
		\alpha_1 n^*_1 \\
		\alpha_2 n^*_2 \\
		0 \\
		\end{array} } \right) \\[2.5em]
	\lambda_2 = 0 \quad \text{   with   } \quad \boldsymbol{v}_2 = \	\left( {\begin{array}{c}
		1 \\[.4em]
		-1 \\[.4em]
		\frac{k(J_{3,1}-J_{3,2})}{\mu \alpha_3(n^*_1+n^*_2)n^*_3}
		\end{array} } \right)\\[2.5em]
	
		\lambda_3 = -\mu (1-2p_{out})\alpha_3 n^*_3 \quad \text{   with   } \quad \boldsymbol{v}_3 = \	\left( {\begin{array}{c}
			0 \\
			0 \\
			1 \\
			\end{array} } \right)
	\end{array}		
\end{equation}
The linearised trajectories near a given equilibrium point are
\begin{equation}
	\boldsymbol{X(t)} = Ae^{\lambda_1t}\boldsymbol{v}_1 + B\boldsymbol{v}_2 + Ce^{\lambda_3t}\boldsymbol{v}_3 + \boldsymbol{n}^* 
\end{equation}
Since $\lambda_1, \lambda_3 < 0$, as $t \rightarrow \infty$ all trajectories tend to the line 
\begin{equation}
	\boldsymbol{w} = B \boldsymbol{v}_2 \quad + \quad \boldsymbol{n}^*
\end{equation}
Which is equivalent to the line expressed by equations (45-47). This line is known as a centre manifold.\\
\textbf{Theorem 1}(Central Manifold Theorem). \textit{Given $\dot{x}=f(x), x \in \mathbb{R}^n$, f smooth and suppose x=0 is a stationary point. Suppose the Jacobian matrix Df(0) has eigenvalues in sets $\sigma_u$ with $Re(\lambda)>0$, $\sigma_s$ with $Re(\lambda) <0$ and $\sigma_c$ with $Re(\lambda)=0$ and corresponding  generalised linear eigenspaces $E^u$,$E^s$ and $E^c$ respectively. Then there exist unstable and stable manifolds $\boldsymbol{W}^u$, $\boldsymbol{W}^s$ tangential to $E^s$ and $E^u$ at x=0; and an invariant centre manifold $\boldsymbol{W}^c$ tangential to $E^c$ at x=0}\\
The important part of this theorem is that the manifold is invariant (See Shilnikov et al. (2001) for a proof).
Therefore any trajectory that passes onto the manifold at time $t_0$, stays on the manifold for all $t>t_0$. Since $\lambda_1$ and $\lambda_3$ are both negative, then the manifold acts as an attractor. It is possible to derive the behaviour on the manifold, however it is beyond the scope of this project. Further more, when looking at $O(n^2)$ terms the stochasticity of the model becomes more prevalent and it is no longer appropriate to approximate the system as a continuum, rather than a discrete stochastic process. Furthermore the assumptions such as neglecting $p_{in}$ can no longer be justified.\\
The manifold is therefore not an equilibrium point, since the populations still fluctuated, however the populations are attracted to this invariant manifold. 
\begin{figure}[H]
		\centering
		\includegraphics[width=.5\textwidth]{Diagram1.png}
		\caption{Projection of the central manifold onto the $n_1-n_2$ plane. The dark blue line represents the centre manifold, intersecting the $n_i$ axis at $\xi_1 = ln\left(\frac{1-P}{P}\right)-kJ_{1,3}$. Near the manifold (dark blue) the trajectories move along the vectors ($\alpha_1 n^*_1,\alpha_2 n^*_2,0 $). On the manifold, the motion is governed by $O(n^2)$ terms and stochastic `noise'.}
\end{figure}
\begin{figure}
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.6\textwidth}
			\centering
			\includegraphics[width=\textwidth]{15data1.png}
			\caption{}
		\end{subfigure}%
		\begin{subfigure}{.6\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{15data2.png}
			\caption{}
		\end{subfigure}
	}
	\caption{(a) and (b) shows a trail of $L_1=2, L_2=1$. As (b) shows the CoM (geen) of genespace 1 fluctuates between the populations of species 0 and 1 (blue). As predicted $n_0 + n_1$ reaches a fixed point (blue in (a)), however $n_0$ and $n_1$ fluctuate randomly. $n_2$ also fluctuates dependent on the motion of $n_0$ and $n_1$, this is because there is $J_{2,0}\ne J_{2,1}$}
\end{figure}
\subsubsection{Cases (b) \& (c), $\boldsymbol{n_1 = 0}$ or $\boldsymbol{n_2 = 0}$}
In the case that $J_{1,3} \ne J_{2,3}$, the only possible fixed points exist when either $n_1=0$ or $n_2=0$ (Ignoring the trivial case where $n_3=0$).  \\
Fixed point 1 given by
\begin{align}
n_1 &= 0\\[.7em]
n_2 &= \frac{1}{\mu}(ln(\frac{1-P}{P}) - kJ_{2,3})\\[.7em]
n_3 &= \frac{1- P}{P} + kJ_{3,1}
\end{align} 
Fixed point 2 given by
\begin{align}
n_1 &= \frac{1}{\mu}(ln(\frac{1-P}{P}) - kJ_{1,3})\\[.7em]
n_2 &= 0\\[.7em]
n_3 &= \frac{1- P}{P} + kJ_{3,2}
\end{align} 
At fixed point 1, the stability matrix looks like
\[
	 M= (1-2p_{out})
	 \left( {\begin{array}{ccc}
	 	p^1_{off} - P & 0 & 0\\[.5em]
	 	-\mu \alpha_2 n^*_2 & -\mu \alpha_2 n^*_2 & 0\\[.5em]
	 	k \alpha_3 (J_{3,1}-J_{3,2}) & 0 & -\mu \alpha_3 n^*_3\\
	 	\end{array} } \right)
\]
Which have eigenvectors and eignenvalues
\begin{equation}
		\begin{array}{c}
		\lambda_1 = (1-2p_{out})(p^1_{off}-p^2_{off}) \quad \text{   with   } \quad \boldsymbol{v}_1 = \	\left( {\begin{array}{c}
			1 \\
			-1 \\
			\frac{k(J_{3,1}-J_{3,2})}{\mu n_3} \\
			\end{array}}  \right) \\[2em]
		\lambda_2 = -\mu (1-2p_{out})\alpha_2 n^*_2 \quad \text{   with   } \quad \boldsymbol{v}_2 = \	\left( {\begin{array}{c}
			0 \\
			1 \\
			0 \\
		\end{array} } \right)\\[2em]
			\lambda_3 = -\mu (1-2p_{out})\alpha_3 n^*_3 \quad \text{   with   } \quad \boldsymbol{v}_2 = \	\left( {\begin{array}{c}
				0 \\
				0 \\
				1 \\
				\end{array} } \right)\\
		\end{array}	
\end{equation}
Whilst as fixed point 2, the stability matrix looks like 
		 \[
		 M=(1-2p_{out})
		 \left( {\begin{array}{ccc}
		 	-\mu \alpha_1 n_1 & -\mu \alpha_1 n_1 & 0\\[.5em]
		 	0 & P-p^2_{off} & 0\\[.5em]
		 0 & \frac{kn_1}{n_2}(J_{3,2}-J_{3,1}) & -\mu \alpha_3 n_3\\
		 	\end{array} } \right)
		 \]
With corresponding eigenvectors and values,
\begin{equation}
\begin{array}{c}
\lambda_1 = (1-2p_{out})(p^2_{off}-p^1_{off}) \quad \text{   with   } \quad \boldsymbol{v}_1 = \	\left( {\begin{array}{c}
	-1 \\
	1 \\
	\frac{k(J_{3,1}-J_{3,2})}{\mu n_3} \\
		\end{array} } \right) \\[2em]
	\lambda_2 = -\mu (1-2p_{out})\alpha_1 n^*_1 \quad \text{   with   } \quad \boldsymbol{v}_2 = \	\left( {\begin{array}{c}
		0 \\
		1 \\
		0 \\
		\end{array} } \right)\\[2em]
	\lambda_3 = -\mu (1-2p_{out}) \alpha_3 n^*_3 \quad \text{   with   } \quad \boldsymbol{v}_2 = \	\left( {\begin{array}{c}
		0 \\
		0 \\
		1 \\
		\end{array} } \right)
	\end{array}	
	\end{equation}
At both fixed points $\lambda_2$ and $\lambda_3$ are negative, implying there stability in the planes described by $\boldsymbol{v_{2,3}} + \boldsymbol{n^*}$. However the other eigenvector has the opposite signs depending on the fixed point, e.i. $\lambda^{fp1}_1=-\lambda^{fp2}_1$. Therefore if one of the equilibria is stable, then the other is a saddle node. \\
The stability is dependent on $p^1_{off}-p^2_{off}$, which inturn means there is dependence on $J_{13}$ and $J_{23}$. We find that stability if based on interaction strength. Treating $p^i_{off}(J_{i3})$ as identical monotonic functions of $J_{i3}$, we find that the system attracts to the population with the largest interaction value, and the three cases present themselves:\\
\textbf{Case (b), $n_1=0$.} $J_{1,3}<J_{2,3}$. This implies $p^1_{off}-p^2_{off}<0$, which intern implies $n_1=0$ is an unstable fixed point. Therefore we recover a 2-D equilibrium point, $(0, n^*_2, n^*_3)$.\\
\textbf{Case (c), $n_2=0$.} $J_{1,3}>J_{2,3}$. This implies $p^1_{off}-p^2_{off}>0$, which imples $n_2=0$ is an unstable fixed point. Therefore werecover a 2-D equilibrium point, $(n^*_1, 0 , n^*_3).$ 

\begin{figure}[H]
			 	\makebox[\linewidth][c]{%
			 		\begin{subfigure}{.5\textwidth}
			 			\centering
			 			\includegraphics[width=\textwidth]{Caseb.png}
			 			\caption{}
			 		\end{subfigure}%
			 		\begin{subfigure}{.5\textwidth}
			 			\centering 
			 			\includegraphics[width=\textwidth]{Casec.png}
			 			\caption{}
			 		\end{subfigure}
			 	}
			 	\caption{A projection of the system onto the $n_1$-$n_2$ plane. (a) shows the behaviour of the system in cases (b) and (c) respectively.}
\end{figure}
\begin{figure}[H]
		\makebox[\linewidth][c]{%
			\begin{subfigure}{.4\textwidth}
				\centering
				\includegraphics[width=\textwidth]{16data2.png}
				\caption{}
			\end{subfigure}%
			\begin{subfigure}{.4\textwidth}
				\centering 
				\includegraphics[width=\textwidth]{19data2.png}
				\caption{}
			\end{subfigure}
			\begin{subfigure}{.4\textwidth}
					\centering 
					\includegraphics[width=\textwidth]{18data2.png}
					\caption{}
			\end{subfigure}
				}
		\caption{The species labels of the species existent at a given geneteration, with $L_1, L_2 =1$, all other parameters were kept the same as previous trials . Blue shows the species in genespace 1, and red in genespace 2. Green shows the CoM in each genespace.}
	\end{figure}
The realistion of this theory is shown in the Figure 15. Three simulations made with of system of 4 species 0,1,2,3($L_1 = L_2 = 2$). Each simulation uses a J matrix	
			 \[
			 M=
			 \left( {\begin{array}{cccc}
			 	0 & 0 & 0.5 & 0\\
			 	0 & 0 & 0.5 + \epsilon & 0 \\
			 	0.7 & 0.4 & 0 & 0 \\
			 	0 & 0 & 0 & 0
			 	\end{array} } \right) \]
Where $\epsilon = 0$, $0.05$, $0.1$ respectively. In order to limit the system to three variables, all interaction between species 3 have been set to zero, making it unappealing. The is shown as the centre of mass function lies on top of species 2, meaning the vast majority of the population of genespace 2 lies there. For $\epsilon =0$,  a realisation of case (a) is apparent. The changes in population between species 0 and 1 do not seem to tend toward any equilibrium, and instead acts like a random walk between  the two populations.\\
For $\epsilon =0.05$, since $J_{1,2} < J_{0,2}$, there is obviously preference towards species 1, and case (b) is recovered. However, the main difference between the realisation and the theory in this case is due to the stochastic nature of the process, and the mutation mechanic which was neglected. Although species 1 appears to be dominant, species 0 does not have 0 population for the majority of the trial. For close interaction values, stochasticity and mutation still play a large role in the dynamics and large populations can still exist in the unstable population.\\
For $\epsilon =0.1$, similar to $\epsilon =0.05$, however the the difference in interaction 
is larger and the stochastic nature is less prevalent, showing that for interactions with a larger difference, the theoretical cases (b) and (c) can be obtained.\\
\begin{figure}[H]
	\centering
	\includegraphics[width=.6\textwidth]{Bif.png}
	\caption{A bifurcation diagram showing the change in stability with changing $\epsilon$ described above. Full lines show stable equilibria and dashed lines show unstable equilibria. $\xi_1$ and $\xi_2$ show the two fixed points, $(n^*_1, 0,n^*_3)$ and $(0, n^*_2, n^*_3)$ respectively. This bifurcation is know as a transcritical bifurcation. For $\epsilon < 0 $,  $\xi_1$ is unstable and $\xi_2$ is stable, case (c) is recovered. At $\epsilon =0$ the central manifold becomes apparent and case (a) appears. At $\epsilon > 0$, the equilibria have switched criticality.   }
\end{figure}
\subsection{Comparison With Data}
\begin{figure}[H]
	\centering
	\includegraphics[width=.5\textwidth]{Triple.png}
	\caption{The species existent at a given geneteration. Blue show the species in genespace 1, and red in genespace 2. Green shows the CoM in each genespace. The black lines show the start and finishes of two 3 dimensional systems (generations 2119-2125 and 2146-2208).}
\end{figure}
When extrapolating this idea to higher dimensions, we find the exact same preferential behaviour. A good example of this is figure 16. This is the same trial as in figure 9, however focusing on generations 2400-2600. There are two main 3 dimensional q-ESSs highlighted by dotted lines, the first (generations 2119-2125) dominated by species 194, 302 and 495; and the second (generations 2146-2208)dominated by species 67, 345 and 377. In comparison to the 2 dimension q-ESS, these states are short, this one only lasting 75 generations where q-ESS states can last for thousands of generations. This implies that there is some inherent instability or favouritism in the model towards 2 species systems. \\ 
Concentrating on the second case,  $J_{345,67}=0.9099$ and $J_{377,67}=0.9030$, which are sufficiently close such that the population can move from one species to another, similar to figure 14(a).
An interesting aspect of these systems is when thinking about transitions. Since similar interaction values allow the population to shift across from species to species more freely, it could help to describe a new mechansim of transition. This is also visible in figure 16, as aftet the 3D q-ESS, a new more stable 2D q-ESS is found. \\
Due to this new mechanism of transition involving a species with similar interactions, we would expect the system to act particularly differently in than the original TaNa model.
of 2 in the opposite genespace will be developed further.\\
%This mechanism is unique to the model, and has not been observed in the Tangled Nature Model. Therefore the number of transitions and  distribution could differ.
\section{Transitions}
Although the last section alluded to a possible mechanism of transition, as figure 16 shows, this process can happen many times within one transitional period. Therefore studying the dynamics of transitions may not be so useful, and it could be particularly difficult to draw conclusions from in these chaotic regions. Like in many complex systems, from complexity comes simple behaviour, and so it could be more useful to discuss the macroscopic effects these transitions have on the system. \\
As  shown by the 3 dimensional case, there is an affinity towards strategies with higher interaction values. This trait of the model is also apparent during transitions, and species are far more likely to be dominant during q-ESSs if they have large interactions. As figure 17 shows, after roughly generation 1000, most of the combined interactions ($c(a,b)=J_{a,b}+J_{b,a}$) of the dominant species are $>1.5$. 
Using this fact we may be able to treat the system in terms of record statistics. 
\begin{figure}[H]
	\centering
	\includegraphics[width=.5\textwidth]{Correlation.png}
	\caption{The combined interactions of the two dominant species ($J_{a,b}+J_{b,a}$) over 10000 generations. It is clear that species with a $c(a,b)>1.5$ are preferred strategies.}
\end{figure}
\subsection{Record Statistics}
Record statistics are concerned with the time distribution between consecutive records of a certain measurement. For example, if a record statistic is recorded, how long will it be until the next? Using techniques illustrated in Sibani et al. (1993) \textbf{[7]} a surprisingly simple distribution can be deduced.\\
Consider a sequence of independent and identically distributed stochastic variables.
\begin{equation}
\nu_0,\nu_1,...\nu_N,\nu_{N+1},...
\end{equation}
Let $P_N$ be the probability that the variable $\nu_N$ is a record. This probability can therefore be described as
\begin{equation}
P_N = \int_{\infty}^{-\infty}Prob\{max[\nu_0,\nu_1,...\nu_{N-1},] < x\}P_\nu(x) dx
\end{equation}
Where $P_\nu$ is the shared probability density function of variable $\nu$. Also , since we assume that each $\nu$ are independent
\begin{equation*}
Prob\{max[\nu_0,\nu_1,...\nu_{N-1},] < x\}=Prob\{\nu_0< x\}Prob\{\nu_1<\}...Prob\{\nu_{N-1}<\} \\
=[F_{\nu}(x)]^N
\end{equation*}
Where $F_\nu(x)$ is the cumulative density function of $\nu$. Therefore the probability can be expressed as 
\begin{equation}
P_N = \int_{\infty}^{-\infty}[F_{\nu}(x)]^NP_\nu(x) dx
\end{equation}
Using the identity that $P_\nu(x) = \frac{dF_\nu(x)}{dx}$ we obtain the surprising result
\begin{equation}
P_N = \int_{\infty}^{-\infty}[F_\nu(x)]^N \frac{dF_\nu(x)}{dx} dx \\
= \int_{\infty}^{-\infty}[F_\nu(x)]^N dF_\nu(x) = \frac{1}{N}
\end{equation}
Although the value of the record statistics will be dependent on the distribution of $\nu$, the actually time for a record is only dependent on the number of trials that have came before.\\
Assume the this sequence carries on and we hit another record. In order to find time between the records we consider the sequence
\begin{align*}
&[0,m_1, m_2, ...m_{n-1}]\\
&0<m_1<m_2<...<m_{n-1}
\end{align*}
Where $m_i$ is the trial number of the ith record. Then the probability that the statistics $v_l$, $l > m_{n-1}$ is the nth record is
\begin{multline*}
P_n(l,[0,m_1,m_2,...,m_{n-1}])=\int_{-\infty}^{\infty}P_{\nu}(x_{n-1})F_\nu(x_{m_{n-1}})^{l-m_{n-1}}dx_{n-1}\\
*\int_{-\infty}^{x_{n-2}}P_{\nu}(x_{n-2})F_\nu(x_{m_{n-2}})^{m_{n-1}-m_{n-2}-1}
dx_{n-2}...\\
%\int_{-\infty}^{x_{n-2}}P_{\nu}(x_{n-3}) F_\nu(x_{m_{n-1}})^{m_{n-2}-m_{n-3}-1} dx_{n-3}...\\
...*\int_{-\infty}^{x_{2}}P_{\nu}(x_{1}) F_\nu(x_{m_{1}})^{m_{2}-m_{1}-1} dx_{1}\\
*\int_{-\infty}^{x_{1}}P_{\nu}(x_{0}) F_\nu(x_{0})^{m_{1}-1} dx_{0}\\
\end{multline*}
Using the substitution derived in (62), the distribution becomes.
\begin{equation}
P_n(l,[0,m_1,m_2,...,m_{n-1}])= \frac{1}{lm_{n-1}m_{n-2}...m_1m_0}
\end{equation}
Since we have been treading the DisTaNa model as continuous, we find the limit as $\lvert\nu_n-\nu_{n-1}\rvert\rightarrow0$, let $p_n(t)$ be the continuous limit of $P_n(x)$. $p_n$can be defined as
\begin{equation}
p_n(t)= \frac{1}{t}\int_{t_{n-2}}^{t}\frac{dt_{n-1}}{t_{n-1}}\prod_{k=2}^{n-2}
\int_{t_{k-1}}^{t_{k+1}}\frac{dt_k}{t_k}
\int_{t_2}^{1} \frac{dt_1}{t_1}\\
\end{equation}
Assuming again that the variables are independent
\begin{align}
p_n(t)&= \frac{1}{t}\frac{1}{(n-1)!} \int_{1}^{t}\frac{dz}{z}^{n-1}\\[.7em]
& = \frac{1}{t}\frac{log(t)^{n-1}}{(n-1)!} \quad , \quad n = 1,2,...,\infty
\end{align}
Therefore the number of records in at a time follows a log-poisson distribution. The distribution can be thought of a s poisson distribution with varying rate log(t).
\subsection{Statistics}
In order to record when transitions occur, they need to be more thoroughly defined. There are a few ways this can be done. In the TaNa model this is often done by detecting mass extinctions. However since in the DisTaNa model, there usual only exists two or three major species at one time, and so this method is less useful. \\
In this report, the start of a transition will be defined as a change in the two most populous species (one for each genespace), and the transition ends when the new dominant species stabilise again and at least one of the two old dominant species has become extinct. This final caveat avoids recording 3 dimensional q-ESS's with fluctuating populations as transitions, an example of which is shown in figure 6(c).\\
In order to detect a transition in the data, an algorithm was created that iterates through the generations, monitoring the species labels of the largest population in both genespaces and comparing it to the last iteration. If the dominant species at the $i$th generation are not the same as at the $i+x$th generation, then we can assume that a transition has started. A transition ends when for $j>i+x$, we have that the dominant species  of the $j$th generation are the same as the $j+x$th generation, and a new q-ESS has been reached. It is at this point we record the event if one of the old dominate species has a population less than 5\% of the overall population. This is the threshold used before to determine the core species in chapter 5.
\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{Statistics2.png}
	\caption{Flow chart of the algorithm used to detect and record transitions.}
\end{figure}
The variable $x$ acts as the sensitivity of the algorithm. If $x=1$ then the algorithm will iterate through every generation. One might think that $x=1$ may be prone to over counting, however this is not the case. Since the algorithm also searches for an extinction, in the majority of transitions 1 generation is not a long enough time for this to occur. Therefore we observe the opposite happening, and under counting occurs. With large x ($x=100$ for example) under counting is also a problem, although the majority of transitions are usually recorded. A more apparent problem is that of position. Since the algorithm records at the end of each 100 iterations, transitions although recorded will only be recorded to the nearest 100th generation. Although this is not much of a problem when looking at a single population it may become one when determining frequency distributions.
\begin{figure}[H]
			\makebox[\linewidth][c]{%
				\begin{subfigure}{.4\textwidth}
					\centering
					\includegraphics[width=\textwidth]{Transitionx=1.png}
					\caption{}
				\end{subfigure}%
				\begin{subfigure}{.4\textwidth}
					\centering 
					\includegraphics[width=\textwidth]{Transitionx=10.png}
					\caption{}
				\end{subfigure}
				\begin{subfigure}{.4\textwidth}
					\centering 
					\includegraphics[width=\textwidth]{Transitionx=100.png}						\caption{}
				\end{subfigure}
			}
			\caption{(a) and (b) show the population of a particularly turbulent simulation, with parameters $L_{1,2} =8$, $\theta = 0.25$, $p_{mut}=0.005$, $p_{kill}=0.2$, $k=1.3$, $\mu=0.007$. Green shows the overall population whilst bbule and red show the population in genespaces 1 and 2 respectively. The dashed lines show the transitions recorded with different sensitivities. (a) $x=1$, many of the transitions have not been successfully recorded. (b) $x=10$, all transitions have been recorded accurately, but there are signs of over counting. (c)$x=100$ The majority of transitions are records, however do not reflect the actually transition times. }
\end{figure}


\section{Transition Distribution}
Using the method of record statistics and assuming that the distribution is log-poisson, one would expect that the average number of transitions to be
\begin{equation}
E(n)= log(t)
\end{equation}
This is indeed the case with the original TaNa model, and so is a good place to start. However, as Figure 20 shows, this is not the case. In fact the distribution more resembles a power law. Therefore the mean number of transitions can be described by
\begin{equation}
E(n) = c*t^b
\end{equation}
For some exponent $b$ approximated as -0.31, and scaling constant $c$. \\
Figure 21 shows the rate of transitions for different sensitivities, with a naive exponent $\gamma =-0.71$. If the average number of transitons followed a logarithmic relation, then we would expect this exponent to be closer to -1.
\begin{figure}[H]
	\centering
	\includegraphics[width=.7\textwidth]{Cumulative.png}
	\caption{Blue shows the cumulative mean transition for the standard parameters. The black line shows an example of a logarithmic curve, and the red line in an example of a power law relation, $E(n) \sim t^b$, $b = 0.31$. It is apparent that the data more closely fits a power law.}
\end{figure}
\begin{figure}[H]
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.33\textwidth}
			\centering
			\includegraphics[width=\textwidth]{sensitivity50.png}
			\caption{}
		\end{subfigure}
		%
		\begin{subfigure}{.33\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{sensitivity10.png}
			\caption{}
		\end{subfigure}
		%
		\begin{subfigure}{.33\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{sensitivity1.png}
			\caption{}
		\end{subfigure}
	}
	\caption{Blue shows the mean frequency of transitions for 10,000 generation over 400 trials. The orange line is an approximate attempt at describing the relation ($\gamma = -0.71$), showing that the rate of transitions follows a powerlaw $\langle r_T \rangle \sim t^\gamma$. Each figure shows data captured using different sensitivities $x$ (As described in chapter 9). (a) has $x=50$, (b) has $x=10$ and (c) $x=1$.   }
\end{figure}
Figure 21 shows the affect of sensitivity on the distribution. One can see that the overall behaviour of transition rate is similar for in the cases of x=10 and x=50. Both follow the same power law, the only difference being the amplitude of each distribution. This can be judged by the vertical axis intercept. This is to be expected as the larger $x$ means that more events will be captured by a particular point, so there are less points with higher frequency. Conversely, with a small sensitivity there are more points with lower frequencies.\\
There is some correction to initial conditions, which is visible in both cases, however is more prominent and defined in the case of x=10. Therefore for all subsequent statistics, x=10 shall be used as the smaller bin sizes allows for a more detailed picture of the distribution. \\
x=1 follows a very different distribution, and does not reflect the actual distribution of transitions. This is due to effects mentioned in chapter 8.2.
\section{K-dependence}
Since the behaviour of the system appears to follow a power law, it is useful to vary parameters in order to determine if any dependence exists. \\
The most intuitive parameter to consider in $k$. As shown before, transitions will occur between states of equal or similar interaction strength(Similar J entries). Since $k$ acts as an amplifier for the interaction strengths, changing this may indeed have an affect on the behaviour of the system.
\begin{figure}[H]
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.5\textwidth}
			\centering
			\includegraphics[width=\textwidth]{Dist2.png}
			\caption{}
		\end{subfigure}%
		\begin{subfigure}{.5\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{Dist4.png}
			\caption{}
		\end{subfigure}
	}
	\caption{(a) Shows the raw transition frequency data for $k=0.3$ (blue), $0.5$ (orange), $0.7$ (yellow), $1.0$ (purple), $1.3$ (green), over 400 trials each. (b) Shows the Log-Binned data with fits determined by the least square regression for the points passed the initial scaling `hook'($<100$). All other parameters are the same as before trials.}
\end{figure}
Figure 22 shows that the frequency of transitions distributions follow power laws, as shown by the straight line in the log-log plots and the exponent itself obviously has dependence on $k$. Therefore the distribution follows the relation
\begin{equation}
	\langle r_T \rangle \sim t^{\gamma(k)}
\end{equation}
Where $\gamma(k)$ is a descreasing function. Figure 23 helps to map out this relation, however in order to determine $\gamma(k)$ more accurately, analysis must be carried out on extreme $k$ ($k>\xi$).
\begin{figure}[H]
	\centering
	\includegraphics[width=.5\textwidth]{Dist5.png}
	\caption{The gradient of the slope in log-log space for a transition frequency distribution for a given k.}
\end{figure}
\begin{figure}[H]
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.4\textwidth}
			\centering
			\includegraphics[width=\textwidth]{5alive.png}
			\caption{}
		\end{subfigure}%
		\begin{subfigure}{.4\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{5alive2.png}
			\caption{}
		\end{subfigure}
	}
	\caption{The transition frequency ((a)-raw, (b)-Log-Binned) for $k=5$. The blue points show the transition frequency for data including trials that suffer extinction. The orange points show transition frequency for data excluding trials that suffer extinction}
\end{figure}
As discursed in section 6.2, transition data can be gained from high k, however one must be careful when using it. If the extinction rate is high, then many of the trials will not reach higher generations, which will intern increase the power law relationship to larger than is correct. This effect is apparent in figure 24 however is very slight, differing the LSR gradient from -0.956 when including trials which undergo extinction, to -0.910 when removing said trials. To avoid this effect, I shall only be considering trials where extinction does not occur.\\
Using intuition gained from figure 23, the exponent $\gamma(k)$ appears to be following a power law or exponential decay, and therefore may be tending towards a limit. Since we know from previous studies that the transitions in the Tana model follow a log poisson distribution, assuming that -1 is the limiting case  of $\gamma(k)$ might be a good place to start.\\
Using this assumption we can decompose the function into $\gamma(k) = \alpha(k) -1$, where $\alpha(k) \rightarrow 0$ as $k \rightarrow \infty$.
\begin{figure}[H]
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.5\textwidth}
			\centering
			\includegraphics[width=\textwidth]{k.png}
			\caption{}
		\end{subfigure}%
		\begin{subfigure}{.5\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{klog.png}
			\caption{}
		\end{subfigure}
	}
	\caption{A plot of the $\alpha(k)$ versus $k$. The black crosses are data points and the red line represents the LSR fit empirically deduced. The power law is extimated at $\beta=-0.762$. }
\end{figure}
Figure 25 shows the relation between $\alpha$ and $k$. In the log-log plot, the data points follow a linear regression, this is indicative of a power law relation. Using this knowledge, we deduce that the power law $\alpha(k)$ also follows a power law relation with $k$, $\alpha \sim k^\beta$.
Therefore we can derive an empirically deduced function for the dependence of the rate of transition on k as,
\begin{equation}%
% \scalebox{1.5}{ % (c)
\large	\langle r_T \rangle \sim t^{bk^\beta -1}
\end{equation}%
% } % (c)
\begin{figure}[H]
	\centering
	\includegraphics[width=.7\textwidth]{k2.png}
	\caption{A plot of the power law, $\gamma(k)=\alpha(k)-1$ versus k. Blackcrosses show real data, whereas the red dashed line shows the theoratical fit (70), with $\beta = -0.7623$ and $b = -0.531$. One can see that value of the powerlaw appears to be tending towards $\gamma(\infty)=-1$}
\end{figure}
Where $\beta$ and $b$ have been approximated as -0.7623 and -0.531 respectively. Using this insight sheds light onto why the TaNa model, which is usually simulated with large $k$ (k=40 is standard) follows a logarithmic transition distribution. For large k an approximation can be made that  $\langle r_T \rangle \approx -1$. However because of the increasing likely hood of extinction , this characteristic only really comes to light in the DisTaNa model, where small $k$ is a necessity of the model. 
\subsection{No interaction} 
In order to understand this power law behaviour in greater detail, it is useful to look at the model when $k=0$. This will allow us to determine which parts of the behaviour are independent of k.
\begin{figure}[H]
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.5\textwidth}
			\centering
			\includegraphics[width=\textwidth]{Noint5.png}
			\caption{}
		\end{subfigure}%
		\begin{subfigure}{.5\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{Noint2.png}
			\caption{}
		\end{subfigure}
	}
	\caption{(a) log-log plot of transition frequencies, with a predicted fit (orange) with y-intercept = 0.00127. (b) cumulative frequency plot (blue,), predicted linear fit (red) with gradient = 0.0127}
\end{figure}
Figure 27 (a) shows that the rate of transitions for large generations follows an exponent of 0, i.e. a constant rate. This is not surprising, as in the case that $k=0$ there is no preference of one state over another, therefore the dominant species switches randomly as the populations fluctuate with stochastic Brownian motion. This is equivalent to the behaviour following a point poisson process, where the probability density function is given by
\begin{equation}
	P\{N(t)=n\}=\frac{(\lambda t)^n}{n!}e^{-\lambda t}
\end{equation}
Where $\lambda$ is the rate of transition. Therefore the mean number of transitions at a given time $t\ge0$ is given by
\begin{equation}
	E(n) = \lambda t
\end{equation}
This linear relation is shown in figure 27(b). The experimentally deduced rate is $\lambda=0.01277$\\
Even with no interaction strength, initial correction is still visible (figure 27 (a)) and is similar to the correction present with $k>0$. Therefore we can assume that the initial correction is independent of $k$.
The crossover time between this behaviour and the power law may be dependent on $k$, however due to the insensitivity forced by the transition detection algorithm (x=10), and the fact that this crossover happens at low generations ($t_c\approx 100$), it is hard to describe any accurate relation between the crossover time and $k$.\\
\section{Superposition Process}
Although the power law behaviour predicts the behaviour of transitions to a good degree, it is mysterious as to why it happens. 
A possible explanation is that the rate does not follow a single power law, but a superposition for the logarithmic behaviour expressed by the record statistics, and the  point poisson process exhibited by the $k=0$ model.
Evidence for this can be seen in Figure 24 (k=5). As the generations grow ($\sim 10^3$), the rate of transitions changes from the $t^{-1}$ to a flatter distribution.
In this case the rate would follow a distribution described by
\begin{equation}
\langle r_T \rangle \sim t^{-1}+ \delta(k)
\end{equation}
Where $\delta \rightarrow 0$ as $k \rightarrow \infty$. 
Therefore combining the two processes, the mean number of transitions will follow
\begin{equation}
	E(n)= \epsilon(k)log(t) + \delta(k)t
\end{equation}
Since poisson processes are additive. In order to test whether this behaviour could explain the increasing power law phenomenon, it is important to try and classify transitions, to help distinguish which transitions are caused by which behaviours. This will be done in the next chapter.
\section{Negative Transitions}
The assumption used in the record statistics derivation of the log-poisson distribution is that with every transition, the system progresses to a more stable strategy, and therefore a new record is achieved. When applied to the DisTaNa model, this notion translates to the interaction coupling between the two most dominant species ($c_{ab}=J_{ab}+J_{ba}$) always progressively increase. \\
Whether this assumption is true or not can be tested by comparing the interaction couple at the start of a transition ($c_{old}$) and the couple at the end of a transition ($c_{new}$) and taking the difference ($d = c_{new}-c_{old}$). If the theory of record statistics correctly predicts the full behaviour of the model we would expect transitions with negative $d$ not to occur or to occur with a relatively low frequency when compare to positive transitions.\\
Likewise, the model proposed in chapter 11 (78) can also be tested in a similar manner. Assuming that there is a poisson process involved one would expect a constant rate of negative transitions, since the process would be random and non-preferential. Therefore assuming this model is true, we would expect to see a large constant rate of negative transitions coupled with a decrease in positive transitions indicative of the $t^{-1}$ behaviour.\\
\begin{figure}[H]
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.5\textwidth}
			\centering
			\includegraphics[width=\textwidth]{loosenessk=0.png}
			\caption{}
		\end{subfigure}%
	}\\
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.5\textwidth}
			\centering
			\includegraphics[width=\textwidth]{loosenessk=3.png}
			\caption{}
		\end{subfigure}%
		\begin{subfigure}{.5\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{looseness5.png}
			\caption{}
		\end{subfigure}
	}\\
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.5\textwidth}
			\centering
			\includegraphics[width=\textwidth]{loosenessk=13.png}
			\caption{}
		\end{subfigure}%
		\begin{subfigure}{.5\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{looseness5=5.png}
			\caption{}
		\end{subfigure}
	}\\	
	\caption{The number of transitions with difference couplings changes for different k. Blue shows the number of transitions with positive d, orange shows transitions with negative d, and yellow is when d=0. (a) k=0, (b) k=0.3, (c) k=0.5, (d) k=1.3 and (e) k=5.}
\end{figure}
As figure 28 shows, a large proportion a negative transitions exist in all trials. For k=0 we see that the number of positive transitions is equal to the rate of negative transitions. This is to be expected as there is no preference in the transitions as to which strategies are best, and is indicative of the point poisson process explained in chapter 10. The number of zero transitions is vastly higher here accounting for over half of the transitions. This is due to the parameter $\theta=0.25$ which dictates the number of non-zero entries there are. Since the transitions for large generations are uniform we have that the probability of a couple $c(0,0)$ moving to another couple $c(0,0)$ is $(1-\theta)^2=0.56$.\\
As k increases, the preference to certain states becomes larger. The first sign of the this is the the number of zero transitions, which drop to account for approximately a third of transitions for k=0.3, and then to basically zero in k=0.5. \\
As $k$ increases the number of negative transitions also falls in comparison to the number of positive states, however in all 5 figures the frequency of these transition are not low enough as to be ignored, and this is where the record statistics interpretation fails. There is also evidence of the negative transitions followed a more complex structure that a constant rate, and there is clear dependence on the generation count, similar to the positive transitions. This also discounts the idea that the model is a superposition of the $k=0$ and $t^{-1}$ behaviours.\\ 
As $k$ increases there are signs that of the negative transitions becoming less prominent, again pointing toward the idea that the record statistic type explanation is a limiting case of the model. \\
\section{Population Increase}
Since the transitions cannot be recorded precisely, it could be more helpful to measure a statistic that can be, to gain a better understanding of the behaviour. The average popluation is a good example of this. As already shown, the average population in the TaNa model follows a gradual logarithmic increase known as a 'time arrow' (Figure 4). Since this is a documented phenomenon, comparison with the population in the DisTaNa Model would be helpful. 
\begin{figure}[H]
	\centering
	\includegraphics[width=.7\textwidth]{ceiling.png}
	\caption{The average population of of 5 differnet k values over 400 trials each. The population of k=0.5 (blue),1 (orange), 2 (yellow), 3 (purple), 5 (green) are shown, each with their respective ceiling limit (dashed). Black shows the respective crossover times $t_c$ defined in 13.1 for each k.}
\end{figure}
As Figure 29 shows, the average population increase does not follow the time arrow behaviour of the TaNa model. For all k the average population starts with a common behaviour (generations 1-10), after which there is a sharp increase which is dependent on k. After which the population increases asymptotically towards a `ceiling' value. The ceiling value is the largest possible configuration allowed when assuming the model follows a 2D strategy. This value is not an upperbound, and is indeed only an approximation based on assumptions verified in chapters 5 and 6, however empirically this value succeeds in acting as a limit for the population. 
\\For a given $k$, the largest possible populations occur when the occupied species have $c_{ab}=2$. Therefore the ceiling value is described by
\begin{equation}
N_{max} = \frac{2}{\mu}\left(ln\left(\frac{1-P}{P}\right)+k\right)
\end{equation}
Using the equilirbium positions discussed in chapter 6. Fact that a notion of an upper limit can be applied to this model, whereas in the TaNa model it could not, could help to explain the disimilar behaviours. 
\subsection{Crossover Times}
Unlike in the transition frequency, crossover times($t_c$) between universal behaviour and k-dependent behaviour are a lot more obivious in the average population, and therefore more analysis can be carried out. The population follows a common behaviour up until a sharp increase, after which k-dependent behaviour ensues . The centre of this sharp increase will be defined at the crossover time. At this point the gradient of the population is at its largest, therefore we can determine the crossover times by
\begin{equation}
t_c=max\left[\frac{d N}{dt}\right]
\end{equation} 
The black points in figure 29 show the respective crossover times calculated using this definition. One can see for smaller $k$ (k=0.5), the crossover time is misrepresented by definition (76). This is becuase the increase which we use to determine $t_c$ is too small, and is mistaken with the stochastic noise of the model. To avoid this $k>1$ will be used. 
\begin{figure}[H]
	\centering
	\includegraphics[width=.5\textwidth]{tc.png}
	\caption{Log-log plot of the crossover times for different k (black). Blue shows a least square regression fit for the data with a slope of -0.92. }
\end{figure}
Using LSR in the log log space the crossover time follows a power law dependence
\begin{equation}
t_c \sim k^{-0.92}
\end{equation}
Theoretical explanation as to why this relationship holds is uknown at this time. One thought is that $-0.92 \approx -1$ and that the crossover times scale inversely with $k$. However there is no theory for either explanation.
\subsection{Data Collapse}
Since we know how the population limit scales and how the crossover time scales, we can attempt a data collapse. A data collapse is an attempt to map each individual functions onto one unifying behaviour, described by the function $\mathcal{G}(x)$.\\
As discussed before, the population tends towards the ceiling value (80) and therefore rearranging we find that 
\begin{equation}
\frac{\left(\mu N_{max}-2ln\left(\frac{1-P}{P}\right) \right)}{k} = 1
\end{equation}
Making this transformation maps the individual ceilings onto a universal ceiling,  $\mathcal{G(\infty)}=1$ (Figure 31(a)). Figure 31(a) shows that the populations are now scaled in the y-axis. In order to scale in the x axis, one must scale by the crossover times
\begin{equation}
t \rightarrow \frac{t}{k^{-0.92}}= x
\end{equation}

\begin{figure}[H]
	\makebox[\linewidth][c]{%
		\begin{subfigure}{.6\textwidth}
			\centering
			\includegraphics[width=\textwidth]{collapsex.png}
			\caption{}
		\end{subfigure}
		
		\begin{subfigure}{.6\textwidth}
			\centering 
			\includegraphics[width=\textwidth]{Datacollapse.png}
			\caption{}
		\end{subfigure}
	}
	\caption{(a) shows a partial data collapse, where the y-axis has been collapsed according to (78). The black line shows the universal ceiling that each individual ceiling limit has changed to under this transformation. (b) shows a full data collapse, with the x axis collapsed using the tranformation (79).}
\end{figure}
Under these transformations one can see that the different trials follow a common behaviour. There are slight differences which could be due to correction to scaling, as it is more obvious in small $k$, or error in the empirically deduced crossover times. \\
This common behaviour can be described as a universal function $\mathcal{G}(x)$ 
\begin{equation}
	\mathcal{G}\left(\frac{t}{k^{-0.92}}\right)=\frac{\left(\mu N(t;k) - 2ln\left(\frac{1-P}{P}\right)\right)}{k}
\end{equation}
The actually theoretical structure of $\mathcal{G}$ is unknown, however it is obviously different from the time arrow behaviour observed in the TaNa model.
The difference may come from the introduction of a `ceiling' value caused by the preference of 2D systems by the model. In the TaNa model there is no known limitation or preference as to the number of dominant species in a configuration, and therefore one would expect the population capacity would be dependent on the system size $L$. However as discussed, the DisTaNa forces the dynamics into having only 2 dominant species system, which vastly limits the overall population. As $k$ increases this ceiling increases, and for large $k$ with further experimentation we may find that the time arrow behaviour is a limiting case, however the behaviour exhibited in this chapter of the universal function $\mathcal{G}(x)$ suggest that this may not be the case. We see the populations appear to tend towards a function more similar to the Heaviside function centred about $t_c$, rather than the straight time arrow seen in the TaNa model, which alludes to a completely different behaviour.
\section{Conclusion}
The aim of this project was to create and analyse an augmented version of the Tangled Nature Model which takes into account the effect from other outside species. Although fundamentally similar to the TaNa Model, this novel Disjoint Tangled Nature model exhibits largely different behaviour in many respects. For example the equilibrium populations are surprisingly robustly structured and predictable, the transition frequencies follow power law dependencies, and the population growth is no longer logarithmic. There is evidence to suggest that these behaviours may be a result of having to use small $k$ to produce non-negative equilibria, and that the behaviour exhibited in the TaNa model is recovered as $k \rightarrow \infty$. However I believe that this hypothesis lacks the necessary evidence and more work must be done before it is entirely accepted. \\
Furthermore, I have introduced and explored the idea that the behaviour apparent for small $k$ is produced by a superposition of two processes, rather than a single entity. However, such a theory is hard to prove, and again the evidence is lacking.\\
To explore the nature of this model further, future efforts should be placed in observing dependencies on other important variables such as mutation probability ($p_{mut}$) and system size ($L$). Furthermore, a theoretical understanding of the k-dependence of the crossover times could play a vital step in understand how the system evolves. \\
In a wider scope, this model is a classic example of how making small changes to fundemental laws, can have a large impact on the complex system they describe. Extrapolating this notion could suggest that evolution may not be just as simple as following a universal behaviour, and is extremely sensitive to the environment in which it takes place.\\
\newpage
\section{Bibliograpy}

\quad \, \textbf{[1]}-Darwin, C. (1859)- \textit{On the Origin of Species}. \\

\textbf{[2]}-Christensen, K., Di Collobiano, S., Hall, M., Jensen, H. (2002)- \textit{Tangled Nature: A Model of Evolutionary Ecology}. J. theor. Biol. (2002) 216, 7384  \\

\textbf{[3]} Sibani P., Jensen H. (2013)Stochastic Dynamics of Complex Sytems, pages 219-244. Imperial College Press\\

\textbf{[4]}-Jones D., Jensen H., Sibani P. (2010)- \textit{Mutual in-
	formation in the Tangled Nature model}. Ecological Modelling, 221(3):400
404.\\

\textbf{[5]}-Piovonia D., Gruji\'{c} J., JensenChapter 'New Procedure' H. (2016)- \textit{Linear stability theory as an early warning sign for transitions in high dimensional complex systems}, . J. Phys. A: Math. Theor. 49 (2016) 295102\\

\textbf{[6]}-Shilnikov L., Shilnikov A., Turaev D., Chua, L.(2001)- \textit{Methods of Qualativie Theory in Nonlinear Dynamics}, page 271. World Scientific.\\

\textbf{[7]}-Sibani P., Littlewood P., (1993)- \textit{Slow Dynamics from Noise Adaptation} \\

\textbf{[8]}-Becker N., Sibani P., (2013)- \textit{Evolution and Non-Equilibrium Physics: A Stuber of the Tangled Nature Model}. EPL, 105 (2014) 18005\\
 
\end{document}

